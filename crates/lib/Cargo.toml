[package]
name = "gamedig"
version = "1.0.0-alpha"
edition = "2021"
license = "MIT"
readme = "README.md"
homepage = "https://gamedig.github.io/"
repository = "https://github.com/gamedig/rust-gamedig"
documentation = "https://docs.rs/gamedig/latest/gamedig"
authors = ["GameDig Organization & Contributors [https://github.com/gamedig]"]
keywords = ["status", "query", "game", "protocol", "service"]
description = "Query game servers and not only."
categories = [
    "parsing",
    "encoding",
    "asynchronous",
    "network-programming",
    "parser-implementations",
]

[dependencies]
# Required Dependencies
thiserror = "1.0.61"
pretty-hex = "0.4.1"
maybe-async = "0.2.10"
error-stack = { version = "0.4.1", features = ["spantrace"] }

# Optional Dependencies
log = { version = "0.4.22", optional = true }
native-tls = { version = "0.2.12", optional = true }
serde_json = { version = "1.0.127", optional = true }
encoding_rs = { version = "0.8.34", optional = true }
async-trait = { version = "0.1.51", optional = true }
tokio = { version = "1.37.0", features = ["full"], optional = true }
serde = { version = "1.0.209", features = ["derive"], optional = true }
ureq = { version = "2.10.1", default-features = false, features = [
    "json",
    "socks-proxy",
], optional = true }
reqwest = { version = "0.12.7", default-features = false, features = [
    "json",
    "socks",
], optional = true }

[features]
default = ["default_client_tokio"]

# Internal Features (Prefix: _<CAPS>)
## I/O
_BUFFER = []
_BUFFER_READ_LATIN_1 = ["dep:encoding_rs"]

## Net
_TCP = ["_BUFFER"]
_UDP = ["_BUFFER"]
_HTTP = ["dep:serde_json"]
_TLS = ["_HTTP"]

# Default Features (Prefix: default_)
#
# Util features for users to enable all features with a runtime
# without having to specify each feature individually
#
# Required: Only 1 can be enabled at a time as it enables rt features
default_client_std = ["client_std", "http_std", "tls_std_default", "all"]
default_client_tokio = [
    "client_tokio",
    "http_tokio",
    "tls_tokio_default",
    "all",
]

# Runtime Client Features (Prefix: client_<RUNTIME>)
#
# Required: Only 1 runtime client type can be enabled at a time
#
# Note: This requirement is protected by a compile time check
client_std = ["maybe-async/is_sync"]
client_tokio = ["dep:async-trait", "dep:tokio"]

# HTTP Client Features (Prefix: http_<RUNTIME>)
#
# Required: Only 1 http client type can be enabled at a time
#
# Required: HTTP Client must match the runtime client
#
# Required: Can only be enabled if a feature with _HTTP is enabled
#
# Note: These requirements are protected by compile time checks 
#
# Dev Note: Has to be stated on user side as there is no way to check
#           if the runtime client is async or sync within a feature.
#           I think using both deps in _HTTP would be a bad idea.
#           If users want to use _HTTP feature they will need to state 
#           the http client to use aswell or use default features.
http_std = ["dep:ureq"]
http_tokio = ["dep:reqwest"]

# TLS Features (Prefix: tls_<RUNTIME>_<FEATURE>)
#
# Required: 1 must be enabled if a feature with _TLS is enabled
#
# Required: TLS feature must match the runtime and http client
#
# Note: These requirements are protected by compile time checks
tls_std_default = ["ureq/tls"]
tls_std_rustls = ["ureq/tls"]
tls_std_native = ["ureq/native-tls", "dep:native-tls"]
tls_std_rustls_native_certs = ["ureq/tls", "ureq/native-certs"]
tls_tokio_default = ["reqwest/default-tls"]
tls_tokio_rustls = ["reqwest/rustls-tls"]
tls_tokio_native = ["reqwest/native-tls"]
tls_tokio_native_vendored = ["reqwest/native-tls-vendored"]

# Library Features
## Attributes (Prefix: attribute_)
attribute_log = ["dep:log"]
attribute_serde = ["dep:serde"]
attribute_adapters = []
attribute_extended_derive = []

## Custom Games

## Protocols
### Query
gamespy_1 = ["_UDP", "_BUFFER_READ_LATIN_1"]
gamespy_2 = ["_UDP"]
gamespy_3 = ["_UDP"]
mumble = ["_TCP"]
quake_1 = ["_UDP"]
quake_2 = ["_UDP"]
quake_3 = ["_UDP"]
teamspeak_2 = ["_TCP"]
teamspeak_3 = ["_TCP"]
unreal_2 = ["_UDP", "_BUFFER_READ_LATIN_1"]
valve = ["_UDP"]
valve_gold_src = ["_UDP"]

### RCON (Prefix: rcon_)
rcon_battleye_2 = ["_TCP"]
rcon_valve_source = ["_TCP"]

## Services (Prefix: service_)
service_alt_v_mp = ["_TLS"]
service_beam_mp = ["_TLS"]
service_discord = ["_TLS"]
service_epic = ["_TLS"]
service_minetest = ["_TLS"]
service_rage_mp = ["_TLS"]
service_valve_master = ["_UDP"]

## Index
all = [
    "all_attributes",
    "all_custom_games",
    "all_query_protocols",
    "all_rcon_protocols",
    "all_services",
]
all_attributes = [
    "attribute_log",
    "attribute_serde",
    "attribute_adapters",
    "attribute_extended_derive",
]
all_custom_games = []
all_query_protocols = [
    "gamespy_1",
    "gamespy_2",
    "gamespy_3",
    "mumble",
    "quake_1",
    "quake_2",
    "quake_3",
    "teamspeak_2",
    "teamspeak_3",
    "unreal_2",
    "valve",
    "valve_gold_src",
]
all_rcon_protocols = ["rcon_battleye_2", "rcon_valve_source"]
all_services = [
    "service_alt_v_mp",
    "service_beam_mp",
    "service_discord",
    "service_epic",
    "service_minetest",
    "service_rage_mp",
    "service_valve_master",
]
